<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Etihadly</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
    <link rel="stylesheet" href="static/style.css">
    <script src="https://code.jquery.com/jquery-3.6.1.js"
        integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
    <script src="static/etihadly.js"></script>
</head>

<body>
    <!-- Nav -->
    <nav class="navbar navbar-dark bg-dark shadow mb-4">
        <!-- a to redirect to home index route -->
        <a class="navbar-brand mx-5" href="/">Etihadly: Smart CPM Parser</a>
    </nav>
    <div class="row">
        <div class="col-3">

<div class="container" style="height: 600px;overflow:hidden">


   
    <ul class="list-group">
        <li class="list-group-item">Parser History</li>
        {% for file in dbfiles %}
        <li class="list-group-item list-group-item-light  my-1 d-flex align-items-center">
                        <div style="width: 30px; height: 30px" class="m-2">
                         <img
                          src="{{url_for('static', filename='images/files.png')}}"
                           alt=""
                           style="width: 100%; height: 100%"
                         />
                       </div>
                        <a href="show_file?file={{file[0]}}">{{file[0]}}</a>
                    </li>
                     {%endfor%}
                </ul>
            </div>
        </div>
        <div class="col-8">
            <div class="container">
                <!-- Upload form -->
                <form class="d-flex align-items-center justify-content-between" method=post enctype=multipart/form-data action="/upload">
                    <div class="form-group w-75">
                        <label for="txtFile" class="mb-2">Upload File</label>
                        <input type="file" name=file class="form-control" id="txtFile" aria-describedby="file"
                            placeholder="Upload your file here" multiple />
                        <small id="filehelp" class="form-text text-muted">You can only upload a txt file.</small>
                    </div>
                    <div class="">
                        <button type="submit" type=submit value="Upload" class="btn btn-warning text-white" style="width: 400px">
                            Submit
                        </button>
                    </div>
                </form>
            </div>

            {% if file_name %}
            <div class="container">
                <div class="container mt-2 text-center">
                    <h5 class="text-muted"> File Uploaded: {{ file_name }} </h5>
                </div>
            </div>
            {% endif %}

            <div class="container mt-4">
                <!-- tabs -->
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <!--li class="nav-item" role="presentation">
                        <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home"
                            aria-selected="true">
                            Raw data
                        </button>
                    </li-->
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="etihadly" data-bs-toggle="pill"
                            data-bs-target="#etihadly-pane" type="button" role="tab" aria-controls="pills-profile"
                            aria-selected="true">
                            Etihadly
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile"
                            aria-selected="false" class="text-warning">
                            Parsed file
                        </button>
                    </li>
                </ul>
                    <div class="tab-content" id="pills-tabContent">
                    <!--div class="tab-pane fade show active" id="pills-home" role="tabpanel"
                        aria-labelledby="pills-home-tab">
                        This is raw data
                    </div-->
                    <div class="tab-pane show active" id="etihadly-pane" role="tabpanel"
                        aria-labelledby="pills-home-tab">
                        <button id="re-parse" class="btn btn-warning m-2 text-white">Parse</button>
                        <div class="editor" id="editor" style="white-space: pre-wrap;" data-gramm="false">{{etihadly | safe}}</div>


                    </div>
                    <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                        <!-- Table container -->
                        <div class="container">
                            <h1>Parsed File</h1>
                            {% if ULDs %}
                            {% set count = namespace(value=1) %}
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>ULDBayDesignation</th>
                                        <th>ULDTypeCode</th>
                                        <th>UnloadingStation</th>
                                        <th>Weight</th>
                                        <th>Load Category</th>
                                        <th>IMP</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for key in ULDs %}
                                    <tr>
                                        <td>{{ count.value }}</td>
                                        <td>{{ key['ULDBayDesignation'] }}</td>
                                        <td>{{ key['ULDTypeCode'] }}</td>
                                        <td>{{ key['UnloadingStation'] }}</td>
                                        <td>{{ key['Weight'] }}</td>
                                        <td>{{ key['LoadCategory'] }}</td>
                                        <td>{{ key['IMP'] }}</td>
                                        {% set count.value = count.value + 1 %}
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% else %}
                            <p>Upload a file above to see the parsed data</p>
                            {% endif %}
                        </div>
                        <div class="container">
                            <h2>Errors</h2>
                            <div class="alert alert-danger" role="alert">Error</div>
                            <div class="alert alert-danger" role="alert">Error</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- error console -->
    <!-- bootstrap Javascript -->
    <script>
        let res = '{{result}}'
        console.log(JSON.stringify(res, null, "8"))
     //  console.log(JSON.stringify(res))
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
    <script>
        $("#editor").click(function () {
            this.contentEditable = true;
        });
    </script>
</body>

</html>